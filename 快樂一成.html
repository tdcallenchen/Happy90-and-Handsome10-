<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>ç¥ç§˜ PK æ’åè³½</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --main:#6366f1;
  --bg1:#eef2ff;
  --bg2:#f8fafc;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  min-height:100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  background: linear-gradient(135deg,var(--bg1),var(--bg2));
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
}

.app{
  width:100%;
  max-width:420px;
}

h1{
  text-align:center;
  margin-bottom:10px;
}

input,textarea{
  width:100%;
  border-radius:12px;
  border:1px solid #ddd;
  padding:12px;
  font-size:16px;
  margin-bottom:10px;
}

button{
  width:100%;
  border:none;
  border-radius:14px;
  padding:16px;
  font-size:18px;
  cursor:pointer;
  background:var(--main);
  color:#fff;
  transition:.15s;
}

button:hover{ transform:scale(1.03); }

.card{
  background:#fff;
  border-radius:20px;
  padding:24px;
  box-shadow:0 12px 30px rgba(0,0,0,.12);
  text-align:center;
  margin-top:20px;
}

.vs{
  margin:20px 0;
  font-weight:bold;
  color:#888;
}

.pick{
  background:#f1f5f9;
  color:#111;
  margin:8px 0;
}

.pick:hover{
  background:var(--main);
  color:#fff;
}

.progress{
  text-align:center;
  color:#666;
  margin-top:12px;
  font-size:14px;
}

.result{
  font-size:20px;
  margin-top:10px;
}

.crown{
  font-size:42px;
}
</style>
</head>

<body>
<div class="app">

<h1>ğŸ”¥ ç¥ç§˜ PK ğŸ”¥</h1>

<input id="me" placeholder="ä½ çš„åå­—ï¼ˆéœ€åœ¨åå–®å…§ï¼‰">
<textarea id="names" rows="5" placeholder="ä¸€è¡Œä¸€å€‹åå­—"></textarea>
<button onclick="start()">é–‹å§‹ PK</button>

<div id="game"></div>

</div>

<script>
let current=[], winners=[], idx=0, round=1;
let me='', outRound=null;

const shuffle=a=>{
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
};

function start(){
  me=document.getElementById('me').value.trim();
  const list=document.getElementById('names').value
    .split('\n').map(n=>n.trim()).filter(Boolean);

  if(!me || !list.includes(me)){
    alert('ä½ çš„åå­—å¿…é ˆåœ¨åå–®ä¸­');
    return;
  }

  shuffle(list);
  current=list; winners=[]; idx=0; round=1; outRound=null;
  next();
}

function next(){
  const g=document.getElementById('game');
  g.innerHTML='';

  if(current.length===1){
    g.innerHTML=`
      <div class="card">
        <div class="crown">ğŸ†</div>
        <h2>${current[0]}</h2>
        <div class="result">
          ${current[0]===me
            ? 'ğŸ‰ ä½ æ˜¯ç¬¬ 1 å'
            : `ä½ æ­¢æ­¥ ${rankText(outRound)}`}
        </div>
      </div>`;
    return;
  }

  if(idx>=current.length){
    current=winners; winners=[]; idx=0; round++; shuffle(current);
    next(); return;
  }

  const a=current[idx], b=current[idx+1];
  if(!b){ winners.push(a); idx+=2; next(); return; }

  g.innerHTML=`
    <div class="card">
      <h3>ç¬¬ ${round} è¼ª</h3>
      <button class="pick" onclick="pick('${a}','${b}')">${a}</button>
      <div class="vs">VS</div>
      <button class="pick" onclick="pick('${b}','${a}')">${b}</button>
      <div class="progress">å‰©é¤˜ ${current.length-idx} äºº</div>
    </div>`;
}

function pick(win, lose){
  winners.push(win);
  if(lose===me && outRound===null) outRound=round;
  idx+=2;
  next();
}

function rankText(r){
  if(!r) return '';
  const power=2**r;
  const rank=2**(r-1)+1;
  return `ç¬¬ ${power} å¼·ï¼ˆä¸¦åˆ—ç¬¬ ${rank} åï¼‰`;
}
</script>

</body>
</html>
